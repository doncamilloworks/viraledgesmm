<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TikTok Video with Countdown Timer</title>
    <style>
        #countdown {
            font-size: 36px; /* Increased by 50% */
            margin-bottom: 20px;
        }
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Countdown Timer Display -->
        <div id="countdown">03:00</div> <!-- The timer will adjust based on video length -->

        <!-- TikTok Video Embed -->
        <blockquote class="tiktok-embed" cite="https://www.tiktok.com/@proddoncamillo/video/7417869867056942368" data-video-id="7417869867056942368" style="max-width: 605px;min-width: 325px;" > <section> <a target="_blank" title="@proddoncamillo" href="https://www.tiktok.com/@proddoncamillo?refer=embed">@proddoncamillo</a> Spanish Guitar Type Beat - Fortuna <a title="typebeat" target="_blank" href="https://www.tiktok.com/tag/typebeat?refer=embed">#typebeat</a> <a target="_blank" title="♬ original sound  - Don Camillo" href="https://www.tiktok.com/music/original-sound-Don-Camillo-7417869950721690401?refer=embed">♬ original sound  - Don Camillo</a> </section> </blockquote> <script async src="https://www.tiktok.com/embed.js"></script>
    </div>

    <!-- JavaScript for Countdown Timer, Scroll, and Tab Detection -->
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        // Manually set the video length in seconds here (e.g., 134 seconds, 240 seconds, etc.)
        var videoLength = 134; // Replace this with the actual video length in seconds

        // Set a maximum of 3 minutes (180 seconds)
        var maxLength = 180;

        // If the video is longer than 3 minutes, cap it at 3 minutes
        var timeLeft = videoLength > maxLength ? maxLength : videoLength;

        var countdownElement = document.getElementById("countdown");
        var timer;
        var timerRunning = false;

        // Function to start the countdown
        function startCountdown() {
            if (!timerRunning) {
                timer = setInterval(function() {
                    var minutes = Math.floor(timeLeft / 60);
                    var seconds = timeLeft % 60;

                    if (seconds < 10) {
                        seconds = "0" + seconds;
                    }

                    countdownElement.innerHTML = minutes + ":" + seconds;

                    timeLeft--;

                    if (timeLeft < 0) {
                        clearInterval(timer);
                        countdownElement.innerHTML = "Time's up!";
                    }
                }, 1000); // Update every second
                timerRunning = true;
            }
        }

        // Function to stop the countdown
        function stopCountdown() {
            clearInterval(timer);
            timerRunning = false;
        }

        // IntersectionObserver: Detect if the countdown element is visible on screen
        function handleVisibilityChange(entries) {
            entries.forEach(function(entry) {
                if (entry.isIntersecting && !document.hidden) {
                    startCountdown(); // Resume the countdown when visible and not hidden
                } else {
                    stopCountdown(); // Stop the countdown when not visible
                }
            });
        }

        // Set up IntersectionObserver to detect when the countdown is on screen
        var observer = new IntersectionObserver(handleVisibilityChange, { threshold: 0.5 }); // Trigger when 50% of the element is in view
        observer.observe(countdownElement);

        // Page Visibility API: Detect if the user switches tabs or minimizes the window
        document.addEventListener("visibilitychange", function() {
            if (document.hidden) {
                stopCountdown(); // Stop timer if the page is hidden (user switches tabs or minimizes)
            } else {
                startCountdown(); // Resume timer when the user comes back to the tab
            }
        });

        // Start the countdown initially
        startCountdown();
    });
    </script>
</body>
</html>
